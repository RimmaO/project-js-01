{"mappings":"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","sources":["src/library.js","src/js/header.js","src/js/switch-color-bkg.js","src/render.js"],"sourcesContent":["import './js/modal';\nimport './js/header';\nimport './js/switch-color-bkg';\nimport './js/hero';\nimport './js/footer';\nimport { createListMarkup } from './render';\nimport { getMovieById2 } from './js/API/api';\n\nconst librariesKey = 'b90b64a7e05f9e36894001e36eb3b3c7';\nlet page = 1;\nlet perPage = 9;\n\nconst refs = {\n  libraryList: document.querySelector('.library-list'),\n  loadMoreButton: document.getElementById('loadMore'),\n};\n\nif (refs.libraryList) renderLibraryData();\nif (refs.loadMoreButton) {\n  refs.loadMoreButton.addEventListener('click', () => {\n    page += 1;\n    renderLibraryData();\n  });\n}\n\n// localStorage\nfunction addMovieToLibrary(movieId) {\n  getMovieById2(movieId).then(movie => {\n    movie.genre_names = movie.genres\n      .map(genre => {\n        return genre.name;\n      })\n      .slice(0, 2)\n      .join(',');\n    if (movie.release_date) {\n      movie.release_date = movie.release_date.slice(0, 4);\n    }\n    let libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n    libraries[movie.id] = movie;\n    localStorage.setItem(librariesKey, JSON.stringify(libraries));\n  });\n}\n\nfunction removeMovieFromLibrary(movieId) {\n  let libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  // delete libraries[movieId];\n  localStorage.setItem(librariesKey, JSON.stringify(libraries));\n  if (refs.libraryList) renderLibraryData();\n}\n\nfunction getMovieFromLibrary(movieId) {\n  const libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  return libraries[movieId];\n}\n\nfunction getMoviesFromLibrary() {\n  const libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  return Object.values(libraries);\n}\n\nfunction renderLibraryData() {\n  let movieMarkup = renderMovies();\n  if (!movieMarkup) {\n    movieMarkup = `\n    <div class=\" container\">\n      <p class=\"library-empty__mistake\">OOPS... <br> We are very sorry! <br> You don't have any movies at your library.</p>\n<a class=\"btn-library__link\" onclick=\"window.location.href='catalog.html'\">Search movie</a>\n    </div>\n      `;\n  } else {\n    movieMarkup = `<ul class=\"cards__list films\">${movieMarkup}</ul>`;\n  }\n  refs.libraryList.innerHTML = movieMarkup;\n}\n\nfunction renderMovies() {\n  const allMovies = getMoviesFromLibrary();\n\n  if (!Object.keys(allMovies)) {\n    return null;\n  }\n\n  let movies = allMovies.slice(0, page * perPage);\n\n  const markup = createListMarkup(movies);\n\n  refs.loadMoreButton.style = 'display: none;';\n  if (allMovies.length > page * perPage) {\n    refs.loadMoreButton.style = '';\n  }\n  return markup;\n}\n\n// spiner?\nwindow.onload = function () {\n  document.body.classList.add('loaded_hiding');\n  window.setTimeout(function () {\n    document.body.classList.add('loaded');\n    document.body.classList.remove('loaded_hiding');\n  }, 500);\n};\n","// for mobile menu\n(() => {\n  const mobileMenu = document.querySelector('.js-menu-container');\n  const openMenuBtn = document.querySelector('.js-open-menu');\n  const closeMenuBtn = document.querySelector('.js-close-menu');\n  const toggleMenu = () => {\n    const isMenuOpen =\n      openMenuBtn.getAttribute('aria-expanded') === 'true' || false;\n    openMenuBtn.setAttribute('aria-expanded', !isMenuOpen);\n    mobileMenu.classList.toggle('is-open');\n    const scrollLockMethod = !isMenuOpen\n      ? 'disableBodyScroll'\n      : 'enableBodyScroll';\n    bodyScrollLock[scrollLockMethod](document.body);\n  };\n  openMenuBtn.addEventListener('click', toggleMenu);\n  closeMenuBtn.addEventListener('click', toggleMenu);\n\n  // Закрываем мобильное меню на более широких экранах\n  // в случае изменения ориентации устройства.\n\n  window.matchMedia('(min-width: 768px)').addEventListener('change', e => {\n    if (!e.matches) return;\n    mobileMenu.classList.remove('is-open');\n    openMenuBtn.setAttribute('aria-expanded', false);\n    bodyScrollLock.enableBodyScroll(document.body);\n  });\n})();\n\n// for active page\nconst doc = window.document;\nconst links = doc.querySelectorAll('a');\nconst linksCount = links.length;\nconst currentURL = doc.URL;\n\nfor (let i = 0; i < linksCount; i++) {\n  let linkURL = links[i].href;\n\n  if (currentURL.startsWith(linkURL)) {\n    links[i].classList.add('active');\n  }\n}\n","const refs = {\n  switchIcon: document.getElementById('switch-icon'),\n  body: document.querySelector('body'),\n  iconDay: document.querySelector('.icon-day'),\n  iconNight: document.querySelector('.icon-night'),\n  headerLogoText: document.querySelector('.header-logo-text'),\n  homeLink: document.getElementById('home-day'),\n  catalogLink: document.getElementById('catalog-day'),\n  myLiberyLink: document.getElementById('my-libery-day'),\n  menuLink: document.getElementById('menu-link'),\n  weeklyTrend: document.getElementById('weekly-trend'),\n};\n\nrefs.switchIcon.addEventListener('click', switchColor);\n\nwindow.addEventListener('DOMContentLoaded', addClassColor);\n\nconst KEY_LOCAL_STOREG = 'background';\n// const value = 'value';\n\nfunction switchColor() {\n  refs.body.classList.toggle('bkg-white');\n  switchIcon();\n    switchColorLink();    \n  refs.headerLogoText.classList.toggle('day-logo-text');\n \n  \n\n  \n\n\n\n  const audit = refs.body.classList.contains('bkg-white');\n\n  save(KEY_LOCAL_STOREG, audit);\n}\n\nfunction addClassColor() {\n  const localValue = load(KEY_LOCAL_STOREG);\n  //   console.log(localValue);\n    if (localValue) {\n      switchColorLinkOn();\n    refs.body.classList.add('bkg-white');\n    refs.headerLogoText.classList.add('day-logo-text');\n    refs.switchIcon.classList.add('icon-day');\n    refs.switchIcon.classList.remove('icon-night');\n    } else {\n        switchColorLinkOff();\n      refs.switchIcon.classList.remove('icon-day');\n      refs.switchIcon.classList.add('icon-night');\n    refs.headerLogoText.classList.remove('day-logo-text');\n  }\n}\n\nfunction switchIcon() {\n  refs.switchIcon.classList.toggle('icon-day');\n  refs.switchIcon.classList.toggle('icon-night');\n}\n\n\nfunction switchColorLinkOn() {\n   refs.weeklyTrend.classList.add('weekly-trend-day');\n    refs.catalogLink.classList.add('menu-link-day');\n    refs.homeLink.classList.add('menu-link-day');\n    refs.myLiberyLink.classList.add('menu-link-day');\n    refs.menuLink.classList.add('menu-link-day');\n}\n\nfunction switchColorLinkOff() {\n   refs.weeklyTrend.classList.remove('weekly-trend-day');\n  refs.catalogLink.classList.remove('menu-link-day');\n  refs.homeLink.classList.remove('menu-link-day');\n  refs.myLiberyLink.classList.remove('menu-link-day');\n  refs.menuLink.classList.remove('menu-link-day');\n}\n\nfunction switchColorLink() {\n  refs.weeklyTrend.classList.toggle('weekly-trend-day');\n    refs.catalogLink.classList.toggle('menu-link-day');\n    refs.homeLink.classList.toggle('menu-link-day');\n    refs.myLiberyLink.classList.toggle('menu-link-day');\n    refs.menuLink.classList.toggle('menu-link-day');\n}\n\n\n\n\nconst save = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n};\n\nconst load = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n","export async function getMovieGenres() {\n  const { data } = await axios.get(\n    `${BASE_URL}/genre/movie/list?api_key=${API_KEY}`\n  );\n  return data;\n}\n\nexport async function getGenres() {\n  const genres = await getMovieGenres().then(({ genres }) => genres);\n\n  return { genres };\n}\n\nexport function renderMarkup(data) {\n  getGenres().then(({ genres }) => {\n    //Добавление списка жанров в localStorage\n    saveLs('genresList', genres);\n    if (data.results) {\n      data.results.forEach(film => {\n        const { genre_ids, release_date } = film;\n        genres.forEach(({ name, id }) => {\n          if (genre_ids.includes(id)) {\n            if (genre_ids.length > 2) {\n              genre_ids.splice(2, genre_ids.length - 1);\n            }\n            genre_ids.splice(genre_ids.indexOf(id), 1, name);\n          }\n          film.genre_names = genre_ids.join(', ');\n          if (film.release_date) {\n            film.release_date = release_date.slice(0, 4);\n          }\n        });\n      });\n    }\n    const markupList = createListMarkup(data.results);\n    if (cards) {\n      cards.innerHTML = markupList;\n    }\n  });\n}\n\nexport function createListMarkup(data) {\n  if (data) {\n    return data\n      .map(\n        ({\n          original_title,\n          poster_path,\n          vote_average,\n          id,\n          genre_names,\n          release_date,\n        }) => {\n          let posterPath = ``;\n          if (poster_path) {\n            posterPath = `${IMG_BASE_URL}${IMG_W400}${poster_path}`;\n          } else {\n            posterPath = 'https://i.ibb.co/C0LFwTh/OIF.jpg';\n          }\n\n          let starIcons = '';\n          for (let i = 1; i <= 5; i++) {\n            let starClass = 'fa-star-o';\n            if (i * 2 < vote_average) {\n              starClass = 'fa-star';\n            } else if (i * 2 - 1 < vote_average) {\n              starClass = 'fa-star-half-o';\n            }\n            starIcons += `<span class=\"fa star ${starClass}\"> </span>`;\n          }\n\n          return `<li class='cards-list__item hover-cursor' data-id='${id}'>\n              <img\n                class='cards-list__img'\n                src='${posterPath}'\n                alt='${original_title}'\n                width\n                loading='lazy'\n                data-id='${id}'\n              />\n              <div class='cards-list__wrap'>\n                <div class='cards-list__info'>\n                  <h2 class='cards-list__title'>${original_title}</h2>\n                  <div class='cards-list_second_line'>\n                    <div class='cards-list__text'>\n                      <p>${genre_names} | ${release_date}</p>\n                  </div>\n                </div>\n                </div>\n                <div class='star-rate'>\n                  ${starIcons}\n                </div>     \n              </div>\n              </li>\n              `;\n        }\n      )\n      .join('');\n  }\n}\n"],"names":["parcelRequire","mobileMenu","document","querySelector","openMenuBtn","closeMenuBtn","toggleMenu","isMenuOpen","getAttribute","setAttribute","classList","toggle","bodyScrollLock","body","addEventListener","window","matchMedia","e","matches","remove","enableBodyScroll","$8aad853c076397e7$var$doc","$8aad853c076397e7$var$links","querySelectorAll","$8aad853c076397e7$var$linksCount","length","$8aad853c076397e7$var$currentURL","URL","i","linkURL","href","startsWith","add","$0529b1cf57924152$var$refs","switchIcon","getElementById","iconDay","iconNight","headerLogoText","homeLink","catalogLink","myLiberyLink","menuLink","weeklyTrend","audit","contains","$0529b1cf57924152$var$save","$0529b1cf57924152$var$load","key","value","serializedState","JSON","stringify","localStorage","setItem","error","console","message","getItem","undefined","parse","$54572758c4217ba8$export$a8499f42c92fab5b","data","map","original_title","poster_path","vote_average","id","genre_names","release_date","posterPath","IMG_BASE_URL","IMG_W400","starIcons","starClass","join","$ce3726a01b8ab25a$var$page","$ce3726a01b8ab25a$var$refs","libraryList","loadMoreButton","$ce3726a01b8ab25a$var$renderLibraryData","movieMarkup","allMovies","libraries","Object","values","$ce3726a01b8ab25a$var$getMoviesFromLibrary","keys","markup","slice","style","$ce3726a01b8ab25a$var$renderMovies","innerHTML","onload","setTimeout"],"version":3,"file":"library.0ab06ef3.js.map"}