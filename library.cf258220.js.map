{"mappings":"gBAEQA,EACAC,EACAC,EACAC,E,geAHAH,EAAaI,SAASC,cAAc,sBACpCJ,EAAcG,SAASC,cAAc,iBACrCH,EAAeE,SAASC,cAAc,kBACtCF,EAAa,WACjB,IAAMG,EAC0C,SAA9CL,EAAYM,aAAa,mBAA+B,EAC1DN,EAAYO,aAAa,iBAAkBF,GAC3CN,EAAWS,UAAUC,OAAO,WAI5BC,eAH0BL,EAEtB,mBADA,qBAE6BF,SAASQ,K,EAE5CX,EAAYY,iBAAiB,QAASV,GACtCD,EAAaW,iBAAiB,QAASV,GAKvCW,OAAOC,WAAW,sBAAsBF,iBAAiB,UAAU,SAAAG,GAC5DA,EAAEC,UACPjB,EAAWS,UAAUS,OAAO,WAC5BjB,EAAYO,aAAa,iBAAiB,GAC1CG,eAAeQ,iBAAiBf,SAASQ,M,IAU7C,IALA,IAAMQ,EAAMN,OAAOV,SACbiB,EAAQD,EAAIE,iBAAiB,KAC7BC,EAAaF,EAAMG,OACnBC,EAAaL,EAAIM,IAEdC,EAAI,EAAGA,EAAIJ,EAAYI,IAAK,CACnC,IAAIC,EAAUP,EAAMM,GAAGE,KAEnBJ,EAAWK,WAAWF,IACxBP,EAAMM,GAAGlB,UAAUsB,IAAI,S,CCvC3BC,EAAA,S,WAyCO,SAASC,EAAiBC,GAC/B,GAAIA,EACF,OAAOA,EACJC,KACC,SAAAC,G,IACEC,EAAcD,EAAdC,eACAC,EAAWF,EAAXE,YACAC,EAAYH,EAAZG,aACAC,EAAEJ,EAAFI,GACAC,EAAWL,EAAXK,YACAC,EAAYN,EAAZM,aAEIC,EAAc,GAEhBA,EADEL,EACW,GAAkBM,OAAfC,cAA0BD,OAAXE,UAAuBF,OAAZN,GAE7B,mCAIf,IADA,IAAIS,EAAY,GACPC,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,IAAIC,EAAY,YACR,EAAJD,EAAQT,EACVU,EAAY,UACC,EAAJD,EAAQ,EAAIT,IACrBU,EAAY,kBAEdF,GAAa,wBAAkCH,OAAVK,EAAU,a,CAGjD,MAAO,sDAGML,OAHgDJ,EAAG,0FAInDI,OADAD,EAAW,4BAIPC,OAHJP,EAAe,uFAOYO,OAJvBJ,EAAG,uKAOHI,OAHuBP,EAAe,gJAGrBO,OAAjBH,EAAY,OAKnBG,OALwBF,EAAa,+IAK3BE,OAAVG,EAAU,2F,IAOvBG,KAAK,G,gBC3FNC,EAAe,mCACjBC,EAAO,EAGLC,EAAO,CACXC,YAAalD,SAASC,cAAc,iBACpCkD,eAAgBnD,SAASoD,eAAe,aA8CnC,SAASC,IACd,IAAIC,EAcN,WACE,IAAMC,GApBAC,EAAYC,KAAKC,MAAMC,aAAaC,QAAQb,KAAkB,GAC7Dc,OAAOC,OAAON,IAFvB,IACQA,EAsBN,IAAKK,OAAOE,KAAKR,GACf,OAAO,KAGT,IAEMS,EAASnC,EAFF0B,EAAUU,MAAM,EAxEjB,EAwEoBjB,IAIhCC,EAAKE,eAAee,MAAQ,iBACxBX,EAAUnC,OA7EF,EA6EW4B,IACrBC,EAAKE,eAAee,MAAQ,IAE9B,OAAOF,C,CA7BWG,GAShBb,EARGA,EAQW,iCAA6Cd,OAAZc,EAAY,SAP5C,kRASjBL,EAAKC,YAAYkB,UAAYd,C,CAvD3BL,EAAKC,aAAaG,IAClBJ,EAAKE,gBACPF,EAAKE,eAAe1C,iBAAiB,SAAS,WAC5CuC,GAAQ,EACRK,G,IAyEJ3C,OAAO2D,OAAS,WACdrE,SAASQ,KAAKH,UAAUsB,IAAI,iBAC5BjB,OAAO4D,YAAW,WAChBtE,SAASQ,KAAKH,UAAUsB,IAAI,UAC5B3B,SAASQ,KAAKH,UAAUS,OAAO,gB,GAC9B,I","sources":["src/js/header.js","src/render.js","src/library.js"],"sourcesContent":["// for mobile menu\n(() => {\n  const mobileMenu = document.querySelector('.js-menu-container');\n  const openMenuBtn = document.querySelector('.js-open-menu');\n  const closeMenuBtn = document.querySelector('.js-close-menu');\n  const toggleMenu = () => {\n    const isMenuOpen =\n      openMenuBtn.getAttribute('aria-expanded') === 'true' || false;\n    openMenuBtn.setAttribute('aria-expanded', !isMenuOpen);\n    mobileMenu.classList.toggle('is-open');\n    const scrollLockMethod = !isMenuOpen\n      ? 'disableBodyScroll'\n      : 'enableBodyScroll';\n    bodyScrollLock[scrollLockMethod](document.body);\n  };\n  openMenuBtn.addEventListener('click', toggleMenu);\n  closeMenuBtn.addEventListener('click', toggleMenu);\n\n  // Закрываем мобильное меню на более широких экранах\n  // в случае изменения ориентации устройства.\n\n  window.matchMedia('(min-width: 768px)').addEventListener('change', e => {\n    if (!e.matches) return;\n    mobileMenu.classList.remove('is-open');\n    openMenuBtn.setAttribute('aria-expanded', false);\n    bodyScrollLock.enableBodyScroll(document.body);\n  });\n})();\n\n// for active page\nconst doc = window.document;\nconst links = doc.querySelectorAll('a');\nconst linksCount = links.length;\nconst currentURL = doc.URL;\n\nfor (let i = 0; i < linksCount; i++) {\n  let linkURL = links[i].href;\n\n  if (currentURL.startsWith(linkURL)) {\n    links[i].classList.add('active');\n  }\n}\n","export async function getMovieGenres() {\n  const { data } = await axios.get(\n    `${BASE_URL}/genre/movie/list?api_key=${API_KEY}`\n  );\n  return data;\n}\n\nexport async function getGenres() {\n  const genres = await getMovieGenres().then(({ genres }) => genres);\n\n  return { genres };\n}\n\nexport function renderMarkup(data) {\n  getGenres().then(({ genres }) => {\n    //Добавление списка жанров в localStorage\n    saveLs('genresList', genres);\n    if (data.results) {\n      data.results.forEach(film => {\n        const { genre_ids, release_date } = film;\n        genres.forEach(({ name, id }) => {\n          if (genre_ids.includes(id)) {\n            if (genre_ids.length > 2) {\n              genre_ids.splice(2, genre_ids.length - 1);\n            }\n            genre_ids.splice(genre_ids.indexOf(id), 1, name);\n          }\n          film.genre_names = genre_ids.join(', ');\n          if (film.release_date) {\n            film.release_date = release_date.slice(0, 4);\n          }\n        });\n      });\n    }\n    const markupList = createListMarkup(data.results);\n    if (cards) {\n      cards.innerHTML = markupList;\n    }\n  });\n}\n\nexport function createListMarkup(data) {\n  if (data) {\n    return data\n      .map(\n        ({\n          original_title,\n          poster_path,\n          vote_average,\n          id,\n          genre_names,\n          release_date,\n        }) => {\n          let posterPath = ``;\n          if (poster_path) {\n            posterPath = `${IMG_BASE_URL}${IMG_W400}${poster_path}`;\n          } else {\n            posterPath = 'https://i.ibb.co/C0LFwTh/OIF.jpg';\n          }\n\n          let starIcons = '';\n          for (let i = 1; i <= 5; i++) {\n            let starClass = 'fa-star-o';\n            if (i * 2 < vote_average) {\n              starClass = 'fa-star';\n            } else if (i * 2 - 1 < vote_average) {\n              starClass = 'fa-star-half-o';\n            }\n            starIcons += `<span class=\"fa star ${starClass}\"> </span>`;\n          }\n\n          return `<li class='cards-list__item hover-cursor' data-id='${id}'>\n              <img\n                class='cards-list__img'\n                src='${posterPath}'\n                alt='${original_title}'\n                width\n                loading='lazy'\n                data-id='${id}'\n              />\n              <div class='cards-list__wrap'>\n                <div class='cards-list__info'>\n                  <h2 class='cards-list__title'>${original_title}</h2>\n                  <div class='cards-list_second_line'>\n                    <div class='cards-list__text'>\n                      <p>${genre_names} | ${release_date}</p>\n                  </div>\n                </div>\n                </div>\n                <div class='star-rate'>\n                  ${starIcons}\n                </div>     \n              </div>\n              </li>\n              `;\n        }\n      )\n      .join('');\n  }\n}\n","import './js/header';\nimport './js/hero';\nimport './js/footer';\nimport { createListMarkup } from './render';\nimport { getMovieById2 } from './js/API/api';\n\nconst librariesKey = 'b90b64a7e05f9e36894001e36eb3b3c7';\nlet page = 1;\nlet perPage = 9;\n\nconst refs = {\n  libraryList: document.querySelector('.library-list'),\n  loadMoreButton: document.getElementById('loadMore'),\n};\n\nif (refs.libraryList) renderLibraryData();\nif (refs.loadMoreButton) {\n  refs.loadMoreButton.addEventListener('click', () => {\n    page += 1;\n    renderLibraryData();\n  });\n}\n\n// localStorage\nexport function addMovieToLibrary(movieId) {\n  getMovieById2(movieId).then(movie => {\n    movie.genre_names = movie.genres\n      .map(genre => {\n        return genre.name;\n      })\n      .slice(0, 2)\n      .join(',');\n    if (movie.release_date) {\n      movie.release_date = movie.release_date.slice(0, 4);\n    }\n    let libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n    libraries[movie.id] = movie;\n    localStorage.setItem(librariesKey, JSON.stringify(libraries));\n  });\n}\n\nexport function removeMovieFromLibrary(movieId) {\n  let libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  delete libraries[movieId];\n  localStorage.setItem(librariesKey, JSON.stringify(libraries));\n  if (refs.libraryList) renderLibraryData();\n}\n\nexport function getMovieFromLibrary(movieId) {\n  const libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  return libraries[movieId];\n}\n\nfunction getMoviesFromLibrary() {\n  const libraries = JSON.parse(localStorage.getItem(librariesKey)) || {};\n  return Object.values(libraries);\n}\n\nexport function renderLibraryData() {\n  let movieMarkup = renderMovies();\n  if (!movieMarkup) {\n    movieMarkup = `\n    <div class=\" container\">\n      <p class=\"library-empty__mistake\">OOPS... <br> We are very sorry! <br> You don't have any movies at your library.</p>\n<a class=\"btn-library__link\" onclick=\"window.location.href='catalog.html'\">Search movie</a>\n    </div>\n      `;\n  } else {\n    movieMarkup = `<ul class=\"cards__list films\">${movieMarkup}</ul>`;\n  }\n  refs.libraryList.innerHTML = movieMarkup;\n}\n\nfunction renderMovies() {\n  const allMovies = getMoviesFromLibrary();\n\n  if (!Object.keys(allMovies)) {\n    return null;\n  }\n\n  let movies = allMovies.slice(0, page * perPage);\n\n  const markup = createListMarkup(movies);\n\n  refs.loadMoreButton.style = 'display: none;';\n  if (allMovies.length > page * perPage) {\n    refs.loadMoreButton.style = '';\n  }\n  return markup;\n}\n\n// spiner?\nwindow.onload = function () {\n  document.body.classList.add('loaded_hiding');\n  window.setTimeout(function () {\n    document.body.classList.add('loaded');\n    document.body.classList.remove('loaded_hiding');\n  }, 500);\n};\n"],"names":["mobileMenu","openMenuBtn","closeMenuBtn","toggleMenu","document","querySelector","isMenuOpen","getAttribute","setAttribute","classList","toggle","bodyScrollLock","body","addEventListener","window","matchMedia","e","matches","remove","enableBodyScroll","$d35165bd5db5382a$var$doc","$d35165bd5db5382a$var$links","querySelectorAll","$d35165bd5db5382a$var$linksCount","length","$d35165bd5db5382a$var$currentURL","URL","$d35165bd5db5382a$var$i","$d35165bd5db5382a$var$linkURL","href","startsWith","add","parcelRequire","$7eec03c6472b26c7$export$a8499f42c92fab5b","data","map","param","original_title","poster_path","vote_average","id","genre_names","release_date","posterPath","concat","IMG_BASE_URL","IMG_W400","starIcons","i","starClass","join","$cecbdd76f2d3d4bd$var$librariesKey","$cecbdd76f2d3d4bd$var$page","$cecbdd76f2d3d4bd$var$refs","libraryList","loadMoreButton","getElementById","$cecbdd76f2d3d4bd$export$4a6ed82f1ca9e433","movieMarkup","allMovies","libraries","JSON","parse","localStorage","getItem","Object","values","keys","markup","slice","style","$cecbdd76f2d3d4bd$var$renderMovies","innerHTML","onload","setTimeout"],"version":3,"file":"library.cf258220.js.map"}